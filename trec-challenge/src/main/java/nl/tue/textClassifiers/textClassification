//download mallet from http://mallet.cs.umass.edu/download.php
// we need bin/mallet. 

on CAPA.win.tue.nl mallet path is '/home/data/trec_challenge/classification/mallet-2.0.7'
let's denote the directory as $mallet$ 

## Export data from database
training DATA:
mv /tmp/*.txt . (or specify four files generated by mysql)

//join all desc-raitings
cat SN_description_classification_desc_raiting.txt description_classification_desc_raiting.txt > desc_raiting.txt

/join all url rainting
 cat SN_description_classification_url_raiting.txt description_classification_url_raiting.txt > url_raitings.txt

DATA is located in  $mallet$/input_data

cd $mallet$
mkdir imported_data
bin/mallet import-file --input input_data/desc_raiting.txt --output imported_data/desc_raiting.mallet
bin/mallet import-file --input input_data/url_raitings.txt --output imported_data/url_raiting.mallet

//test which classifier to use for desc
bin/mallet train-classifier --input imported_data/desc_raiting.mallet --training-portion 0.9  //default is Naive Bayes
bin/mallet train-classifier --input imported_data/desc_raiting.mallet --training-portion 0.9  --trainer MaxEnt
bin/mallet train-classifier --input imported_data/desc_raiting.mallet --training-portion 0.9  --trainer C45
//the same for url.mallet. For both cases MaxEnt is better.

# Train Models:
bin/mallet train-classifier --input imported_data/desc_raiting.mallet --trainer MaxEnt  --output-classifier trained_classifiers/decs.classifier
bin/mallet train-classifier --input imported_data/url_raiting.mallet --trainer MaxEnt  --output-classifier trained_classifiers/url.classifier   

# Use Models:
//test data SELECT description INTO OUTFILE '/tmp/test_SN_description.txt'  LINES TERMINATED BY '\n'  from venues;
bin/mallet classify-file --input input_data/test_SN_description.txt --output classified_data/desc.txt  --classifier trained_classifiers/decs.classifier
bin/mallet classify-file --input input_data/test_SN_description.txt --output classified_data/url.txt  --classifier trained_classifiers/url.classifier